import Ember from 'ember';
import config from '../config/environment';
import { commandFactory, CMD_TYPES } from '../models/commands';

export default Ember.Component.extend({
    tagName: 'ul',
    classNames: ['script-builder', 'sections'],
    showNewCommandEditor: false,
    commandKeys: Object.keys(CMD_TYPES),
    commands: [
        commandFactory(CMD_TYPES.$modelname, '// Generated by http://blackmesasource/qc v' + config.version)
    ],

    change: function (e) {
        var $target = Ember.$(e.target);

        if ($target.is('#new-command select')) {
            this.get('commands').pushObject(commandFactory($target.val()));
            this.set('showNewCommandEditor', false);
        }
    },

    actions: {
        addCommand: function () {
            this.set('showNewCommandEditor', true);
        },

        deleteCommand: function (command) {
            this.get('commands').removeObject(command);
        },

        replaceCommand: function (command, type) {
            var commands = this.get('commands'),
                index = commands.indexOf(command);

            commands.removeAt(index);
            commands.insertAt(index, commandFactory(type));
        },

        download: function () {
            console.log('download');
        },

        copyToClipboard: function () {
            //var event = new ClipboardEvent('copy', { dataType: 'text/plain', data: 'hello from the clipboard!' });
            //document.dispatchEvent(event);
        }
    }
});
